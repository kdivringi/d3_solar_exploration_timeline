<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://code.jquery.com/jquery.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script type="text/javascript">
    function draw(locs) {
        	
      // Set scale & axis regions
      var margin = 75,
          width = 940 - margin,
          height = 700 - margin;

      // d3.select("body")
      //   .append("h2")
      //   .text("Timeline of Solar System Exploration");

      svg = d3.select("#vis")
        .append("svg")
        .attr("width", width + margin)
        .attr("height", height + margin);

      // Draw Places / Year Scales

      var g = d3.select("svg")
        .append('g')
        .attr("class", "locs");

      g.selectAll("text")
        .data(locs)
        .enter()
        .append("text")
        .attr("y", function (d) {return +d['position']*height;})
        .text(function (d) {return d['name'];});
      
      var p_delta = 0.07;
      g.selectAll("rect.back")
        .data(locs)
        .enter()
        .append("rect")
        .attr("class", "back")
        .attr("x", margin)
        .attr("y", function (d) { 
          return +d['position']*height - 0.5*p_delta*height;
        })
        .attr("width", width - margin)
        .attr("height",p_delta*height)
        .style("fill", function (d) {return d['color'];})
        .style("opacity", 0.2);

      var loc_scale = d3.scale.ordinal()
        .domain(locs.map(function (d) {return d['name'];}))
        .range(locs.map(function (d) {return +d['position']*height;}));


      var time_scale = d3.scale.linear()
        .range([margin, width])
        .domain([1958, 2015])

      var time_axis = d3.svg.axis()
        .scale(time_scale)
        .orient("bottom")
        .tickFormat(d3.format("04d"));


      // Function to draw mission path
      function draw_missions(data) {
        debugger;
        svg.append('g')
          .attr("class","mission")
          .selectAll("path.trip")
          .data(data)
          .enter()
          .append("path")
          .attr("class", "trip")
          .attr("stroke", "black")
          .attr("stroke-width", 1)
          .attr("stroke-dasharray", "5,5")
          .attr('d', function (d) {
            var x0 = time_scale(d['launch']);
            var x1 = time_scale(d['arrival']);
            var y0 = loc_scale("Earth");
            var y1 = loc_scale(d['destination']);
            return "M" + x0 + " " + y0 + " L" + x1 + " " + y1;
          });
        d3.select("g.mission")
          .selectAll("path.activity")
          .data(data)
          .enter()
          .append("path")
          .attr("class", "activity")
          .attr("stroke", "black")
          .attr("stroke-width", 1)
          .attr("d", function (d) {
            var x0 = time_scale(d['arrival']);
            var x1 = time_scale(d['end']);
            var y0 = loc_scale(d['destination']);
            var y1 = loc_scale(d['destination']);
            return "M" + x0 + " " + y0 + " L" + x1 + " " + y1;
          });
      }

      d3.tsv("solar_exploration.tsv", draw_missions);

      d3.select("svg")
        .append('g')
        .attr('class', 'x axis')
        .attr('transform', "translate(0," + height + ")")
        .call(time_axis);
      


      // Bind and draw everything

    	// Set Mouseover events

    	// Set button actions/transitions
    	
    }
      </script>
  </head>
<body>
  <div class="container">
  <div class="row">
    <h1>Timeline of Solar System Exploration</h1>
    <div class="span12" id="vis"></div>
  </div>
  <div class="row">
    <div class="span3" id="planets">
      <h4>Destination</h4>
    </div>
    <div class="span3" id="years">
      <h4>Eras</h4>
    </div>
    <div class="span3" id="types">
      <h4>Mission Types</h4>
    </div>
    <div class="span3" id="efficiency">
      <h4>Mission Success</h4>
    </div>
  </div>
  </div>

  <script type="text/javascript">
  /*
    */
  d3.tsv("locations.tsv", draw);
  </script>
</body>
</html>
